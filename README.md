# COVIDindiaHospitalTracker

Tried to make a website that finds out state-wise the number of active COVID-19 cases in India and the approximate number of hospital beds that remains for servicing patients(these patients may or may not be affected by COVID-19, it displays the number of beds that may be used for servicing patients inflicted with covid-19 or other ailments). It is noted that the number of hospital beds per state has been obtained from https://www.kaggle.com/sudalairajkumar/covid19-in-india which in turn have got the data from https://pib.gov.in/PressReleasePage.aspx?PRID=1539877. Values are subject to change and should be treated as an approximation. Tech used = Python(BeautifulSoup, JSON) and Node(NO EXPRESS OR EJS CUSTOM CODE WRITTEN FOR TEMPLATING since the templating needed is very simple)

Tech used to realize this

:herb: Python has been employed to obtain the number of active cases, state-wise from covid19india.org. At first requests module was used but later it was found that the table in the page is injected by JavaScript(specifically as on 02-11-2020 React was being used) after it loads so the html cannot be obtained using requests or urllib. Selenium was used to get the html of the page.

:herb: Once the html is extracted, the table was parsed using the powerful BeautifulSoup library in Python. The names of states and the corresponding active cases, total hospital beds and remaining hospital beds were extracted and stored in a json file. As of 31-10-2020 the active cases has a class=total and the title of the element holds the number of active cases. All columns have a class=total, column 2 or index 1 element returned by findall is the one to be considered.

:herb:A node.js server was set up to serve pages. Server is set up WITHOUT USING EXPRESS. Within the server, whenever the requested page is the one that displays the table(state and hospital beds count), the python script is executed by spawning a child process. When a request for the main.html is received, the python script is executed, the data obtained from Python script is then injected into main.html using custom code NOT USING EJS or template engines as so much stuff isnt necessary for our small application. We simply have a div with class flex-item, child of a div with class flex-container. For each state, we need a div with class flex-item which shows State: State name, Active Cases, Total Hospital Beds and Beds left: The required value. Custom template is defined using a pair of @. This is extracted using substring. The point at which data is to be inserted inside the template is indicated by a single brace {. The location of { is obtained by substring and in place of the bracket, the required data is placed. This process is repeated for each state. The final string is sent to client after setting the response headers, using response.write(data). The main.html is read using simple fs.readFile. The contents of file read is passed to augment_template along with the data to be inserted into the template. The number of beds state wise is stored as a JSON and the active cases subtracted suitably. @ cannot be used for anything else in HTML other than marking template so all CSS media query stuff must be externally linked. Also, { must have 1 space before and 1 space after it.

Difficulties faced and updated:
1. Selenium returns the page as soon as it gets loaded but does not wait for the correspoding JavaScript to be injected to the page. So it is made to wait using expected conditions where the condition is that a css class element state-name has been loaded.
2. The driver for Selenium required frequent updation to match Chrome version.
3. Whenever the layout of the page is updated, it causes problems as extraction is heavily dependant on the class names of specific components.
4. To serve webp images, it is to be included in the list of accepted MIME times as image/webp.

Start server and localhost:1337/main.html

![pic](https://user-images.githubusercontent.com/41965125/102903427-55c9be00-4496-11eb-9953-fb1c46d5cd11.png)